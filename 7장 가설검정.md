# 07 가설검정

## 01 가설검정과 유의수준

검정 : 추정한 결과를 과연 받아들일 만한 것인지 조사자가 설정한 기준과 비교해 채택 여부를 판단하는 과정 ( 조사가 의미가 있었는지 판단하는 것)

추론 : 가정을 세우는 것 + 가정이 맞는지 틀린지 확인해보는 것(가설검정)

#### 가설

 : 모수가 어떠할 것이다 라는 조사자의 추측

##### 1) 귀무가설 (영가설) H0

- 일반적으로 믿어온 사실을 가설로 설정한 것
- 증명을 하지 않음

##### 2) 대립가설(연구가설) H1

- 공공연하게 사실로 받아들여진 현상에 대립되는 가설 (연구목적)
- 연구를 통한 증명이 목적



#### 가설검정의 오류

- 오류 : 의사결정의 실패

1) 제1종 오류 : 귀무가설을  채택해야 함에도 귀무가설을 기각하는 경우
$$
\alpha
$$
2) 제 2종 오류 : 귀무가설을 기각해야 함에도 귀무가설을 채택하는 경우
$$
\beta
$$


- 가설검정력 :  대립가설(H1)이 사실인 상황에서(귀무가설이 거짓일 때 ) 귀무가설(H0)를 기각할 확률

  ​						= 2종오류가 발생하지 않을 확률 
  $$
  1-\beta
  $$
  

#### 양측검정과 단측검정

- 가설을 기각할 수 있는 검정방법
- 채택, 기각의 기준은 항상 귀무가설이다.
- 조사 결과가 유의수준 알파에 포함되면 기각하고, 포함되지 않으면 채택한다. 

1) 양측검정

- 대립가설을 검정하여/ 귀무가설을 기각하고 -> 대립가설을 채택
- 가설의 채택 여부는 유의수준 알파로 판단한다. 
- 기각역과 채택역으로 나뉘고, 기각역이 양쪽으로 나타나기 때문에 양측검정이라고 한다.

2) 단측검정

- 대립가설의 한쪽만 검정하는 방식

  ex. 음료의 용량이 250ml보다 적다 or 250ml보다 많다 중 둘중 하나만 살펴보는 것



#### 가설검정의 절차

1. 가설 수립 : 귀무가설과 대립가설을 수립
2. 유의수준을 결정한다
3. 기각역을 설정한다
4. 통계량을 계산해 기각역과 비교한다
5. 귀무가설과 대립가설 중 어떤 가설을 채택할지 의사결정한다.



#### 가설검정의 기본요소

1. 무작위 추출
2. 통계적 독립성 : 어떤 하나의 관측치가 다른 관측치에 영향을 미치지 않는다.
3. 정규성 : 관측치가 충분히 많아 정규분포를 구성해야한다.
4. 등분산성 : 둘 이상의 표본을 비교할 때는 두 집단이 서로 등분산을 구성해야 한다. (등분산을 유지하지 않는 경우 평균을 비교하는 의미가 없어진다.) *등분산 : 통계적 모형에서 가정하는 관측값의 오차항이 모든 관측값에 대해 같은 분산을 가지는 것
5. 표본의 크기는 가능하면 크게 설정한다.



## 02 단일 모집단 평균의 가설검정



### 1) 모분산을 아는 경우의 가설검정

- 가설수립
  $$
  귀무가설 : H_0 ; \mu=\mu_0
  \\
  대립가설 :  H_1 ; \mu \neq \mu_0
  $$

- 양측검정 

- $$
  \pm z_\frac{\alpha}{2} 이용
  $$

  

<img src="C:\Users\seok\Documents\파이썬\worldleader\기초통계학\양측검정.jpg" alt="양측검정" style="zoom:50%;" />

- 단측검정
$$
   H_1 ; \mu < \mu_0
   \\
    H_1 ; \mu > \mu_0
  $$
  
  
  

<img src="C:\Users\seok\Documents\파이썬\worldleader\기초통계학\우측검정.jpg" alt="우측검정" style="zoom:50%;" />

<img src="C:\Users\seok\Documents\파이썬\worldleader\기초통계학\좌측검정.jpg" alt="좌측검정" style="zoom:50%;" />

### 2) 모분산을 모르는 경우의 가설검정



##### 01) 표본이 큰 경우의 가설검정

- 표본이 크면 중심극한 정리에 의해 큰 표본의 표준편차를 모분산의 표준편차 대신 사용한다.

- $$
  s^2 -> \sigma^2 (중심극한정리)
  \\
  Z=\frac{\bar{x}-\mu}{s/\sqrt{n}}
  $$

  

##### 02) 표본이 작은 경우의 가설검정

- t분포를 이용한다

- $$
  t_{n-1}=\frac{\bar{x}-\mu}{s/\sqrt{n}}는 자유도 (n-1)에서 t분포를 따른다.
  $$



##### 03) p값을 이용한 가설검정

- 채택/기각에 대한 강도를 표현하기 위해서

- 채택/기각에 대한 기준을 확률로 나타낸다.

- p값 = 귀무가설을 기각하기 위한 최대한의 한계점, 유의수준(알파)로부터 멀리 떨어져 있는 확률

  - p값의 다른 표현들 : p-value, significance leve, sig, 유의수준, 유의확률

- p값이 0.05보다 작거나 같다면 귀무가설을 기각한다

  - 귀무가설을 채택할지 기각할지의 기준은 
    $$
    \alpha = 0.05
    $$

## 03 단일 모집단 비율 및 분산의 가설검정



#### 01) 모집단 비율의 가설검정

- 비율에 대한 검정

- 모집단으로부터 표본을 추출해서, 비율을 구한다. --> 모비율과 표본비율이 동일한지 알아보는 것

  ex. 서비스 만족도 조사를 실시하는데, 고객의 80% 이상이 서비스에 만족하는지 알아보려 한다. 무작위로 선택한 100명을 대상으로 만족도 조사를 한 결과 78명이 만족한다고 하였다. 유의수준을 고려해서 검정한다.

- 모비율 p를 구하기 위한 표본비율 분포의 표준편차를 이용한다.

- $$
  s_\hat{p}=\sqrt{\frac{p(1-p)}{n}}
  \\
  Z= \frac{\hat{p}-p}{\sqrt{\frac{p(1-p)}{n}}}
  $$

  

- 귀무가설을 기각하려면?
  $$
  양측검정 : Z>z_\frac{\alpha}{2}, Z<z_\frac{\alpha}{2}
  \\
  단측검정 : H_1 : \hat{p}<p이면 Z<z_\alpha
  \\        H_1 : \hat{p}>p이면 Z>z_\alpha	
  $$
  

#### 02) 모집단 분산의 가설검정

- 분산에 대한 검정

- 표본을 추출해서 표본분산을 계산한다. 표본분산을 이용해 모분산이 맞는지 검정한다.

- 카이제곱 분포를 이용한다. (분산에 대한 가설검정)
  $$
  분산이 \sigma^2인\,모집단으로부터\, n개의\, 표본을 \,추출해서\, 표본분산\, s^2을\, 계산하면
  \\
  \, 이\, 표본은\, 자유도가\, (n-1)인\, x^2분포를\, 따르며,\, 검정통계량은
  \\
  X^2_{(n-1)} = \frac{(n-1)s^2}{\sigma^2} 이다.
  $$
  
- 귀무가설을 기각하려면?

  - 양측검정
    $$
    X^2<X^2_{(n-1,1-\frac{\alpha}{2})}, X^2>X^2_{(n-1,\frac{\alpha}{2})}
    $$
    
- 단측검정
    $$
    좌측검정 : H_1 : \sigma^2<\sigma_0^2 이면 \, X^2<X^2_{(n-1, 1-\alpha)}
    \\
    우측검정 :  H_1 : \sigma^2>\sigma_0^2 이면 \, X^2>X^2_{(n-1, \alpha)}
    $$
    



### 연습문제

1. 가설의 개념과 종류

가설이란 주어진 사실 혹은 조사하고자 하는 사실이 어떠하다는 주장이나 예측이다. 

- 귀무가설 : 일반적으로 믿어지는 사실이라 조사의 의미가 없는 가설
- 대립가설 : 귀무가설에 대해 대립이라는 가설을 설정하고 연구한다.



2. 검정의 개념과 종류를 유의수준과 함께 설명하라

검정이란 귀무가설과 대립가설 중 어떤 것이 맞는것인지 판단하는 것이다. 

귀무가설의 채택여부를 판단해서, 귀무가설을 기각할 때 대립가설을 받아들이는 논리를 이용한다. 

가설을 기각할 수 있는 검정방법에는 양측검정과 단측검정 두가지가 있다.

- 양측검정 : 대립가설을 검정해 - 귀무가설을 기각하고 대립가설을 채택하는 것
- 단측검정 : 대립가설을 조사목적에 따라 기각되어야 하는 영역이 작다 혹은 많다는 것으로 수립한다.

기각이 되는 기준은 조사결과가 유의수준에 포함되면 기각하고, 포함되지 않으면 채택한다. 



3. 통계적 판단을 하는 데 있어 유의수준의 역할

   추정은 언제나 틀릴 가능성이 있기 때문에 오류가능성(확률)을 제시한다. 모수의 추정이 맞을 확률을 (1-알파) 로 표시한다. (알파를 유의수준이라고 한다)



4. 통계적 오류에 대해 설명하고, 오류를 피하기 위해서는 어떻게 해야하는지 설명하라.

   아무리 유의수준으로 가설을 검정했더라도 통계는 틀릴 가능성을 반드시 가지고 있다. 이처럼 통계학을 이용해서 모수를 추정하더라도 실제와는 다른 결론에 도달하는 것을 오류라 한다. 

   - 1종 오류 : 귀무가설을 채택해야 함에도 귀무가설을 기각하는 경우
   - 2종 오류 : 귀무가설을 기각해야 함에도 귀무가설을 채택하는 경우



- 1종 오류를 피하려면 귀무가설을 채택하기 위한 채택역을 넓히고 기각역을 줄인다.(알파 값을 줄인다.) 그러나 이 경우 2종오류가 나타날 수 있는 가능성이 생기기 때문에 1종오류와 2종오류를 피할 수 있는 적절한 유의수준을 선택해야한다.



5. 전기자동차에 들어가는 배터리기술이 발달하면서 점점 운행거리가 늘어나고 있다. 제조사에서 주장하는 전기자동차의 운행 거리가 완충시 600km라는 광고를 확인하기 위해 직접 조사를 하고자 한다. 표본 121개를 선택해 직접 운행거리를 측정했다. 그 결과 평균 운행거리는 599.2km이고 표준편차는 25km였다. 이때 가설을 수립하고 유의수준 0.05에서 양측검정과 좌측검정을 실시해라.

   - 양측검정
     $$
     z_\frac{\alpha}{2} = 1.96
     \\
     z = \frac{\bar{x}-\mu}{\sigma/\sqrt{n}} = -0.369
     $$
     -1.96~1.96사이에 들어가므로 '전기자동차의 운행거리는 600km이다'라는 귀무가설을 기각할 수 없다.

   - 좌측검정

   $$
   -z_\alpha=-1.96이며, z<-1.96이면 \, 귀무가설을\, 기각한다.
   \\
   z=\frac{\bar{x}-\mu}{\sigma/\sqrt{n}}=-0.369
   $$

   ​	z>-1.96이므로 '전기자동차의 운행거리는 600km이다'라는 귀무가설을 기각할 수 없다.



7. $$
   n=100, \mu=5, \sigma=50, \alpha=0.05, \bar{x}=5.1
   \\
   z=\frac{\bar{x}-\mu}{s/\sqrt{n}}=0.02
   $$

8. $$
   n=150, \hat{p}=0.99, p=1.06, \alpha=0.05
   \\
   z= \frac{\hat{p}-p}{\sqrt{\frac{p(1-p)}{n}}} = 0.0205
   \\
   좌측검정, z_{0.5}=-1.64
   $$

   

계산한 z값 0.0205는 좌측기각역에 속하므로 영업전략교육을 실시하지 않아도 된다. 