# 6장 추정

## 01. 점추정과 구간추정

추론통계 : 표본을 통해 모집단의 성격을 파악

추정의 방법

1. 점추정 : 모수를 특정한 수치로 표현 ex) 30분
2. 구간추정 : 모수를 범위로 추정 ex) 30~40분

추정치  : 모수를 추정하기 위해 선택된 표본을 대상으로 도출한 '통계량'

추정량 : 추정치를 계산하기 위한 도출함수



### 점추정

- 점추정은 오차를 필연적으로 동반한다.



#### 바람직한 점추정량의 조건

1. 일치성 : 표본이 커질수록(모집단의 규모에 근접할수록) 오차가 작아진다.
2. 불편성을 만족한다 : 추정량에 대한 기대값이 모수와 같다.
   - 불편추정량 : 추정량 =모수

$$
E(\hat{\theta}) = \theta 일때의 추정량 \hat{\theta}
$$

- ​	편의가 있다 : 추정량과 모수가 같지 않다.

3. 유효성 : 모수에 대한 추정량의 분산(분포)가 작을수록 추정량이 바람직하다. 

4. 평균 오차제곱 :  평균 오차제곱이 최소여야한다.

- 오차 : 측정치 - 평균
-  모든 편차의 합은 0이 되므로 오차에 제곱을 하여 더한 '평균 오차제곱'이 최소가 되어야한다.

5. 충분성 :  표본이 모집단의 대표성을 가져야 한다. 

- 표본(x1, x2, x3, x4 ...)으로부터 추정량을 추정할 때, 추정량의 정보가 모수에 대한 모든 정보를 포함해야함.

- ex) 확률함수 T(x1,x2,x3...) = x1이라면 추정량=x1이 되므로 다른 정보들을 포함하지 않는다.

  

#### 구간추정

- 신뢰수준 

  - 추정값이 존재하는 범위에 모수가 포함될 확률 ex. 90% 신뢰수준, 95% 신뢰수준 ...

  - $$
    100*(1-\alpha)
    $$

    ​																							알파 : 조사에서 인정되는 오차 수준

    ex. 신뢰수준 95%라면 5%의 오차가 있더라도 의미 있는 조사라고 인식한다.

- 신뢰구간

  - 상한값(추정된 점으로부터 (-)방향)과 하한값(추정된 점으로 부터 (+)방향)의 구간으로 표시한다.
    $$
    모평균(\mu) , 표본평균( \bar{x}), 표준오차 (SE) 일 때
    $$

    $$
    \bar{x}-z * SE \leq \mu \leq \bar{x}+z * SE
    $$

  - z는 표준정규분포표에서 신뢰도에 해당하는 면적을 이용해 구한다.
  
  - <img src="C:\Users\seok\Documents\파이썬\worldleader\기초통계학\z값 구하기.jpg" alt="z값 구하기" style="zoom:50%;" />

<img src="C:\Users\seok\Documents\파이썬\worldleader\기초통계학\표준정규분포표.jpg" alt="표준정규분포표" style="zoom:50%;" />



#### 외워두면 좋을 z값

| z값  | 신뢰수준 |
| :--: | :------: |
| 1.64 |   90%    |
| 1.96 |   95%    |
| 2.58 |   99%    |
| 3.30 |  99.9%   |





### 예제 6-1 구간추정

토익 점수의 평균=500, 표준오차=100일 때, 신뢰도 90%에서 구간추정으로 평균에 대한 모수를 추정해라.
$$
\bar x=500, SE =100, Z=1.64

\\
500-1.64*100 \leq \mu \leq500+1.64*100
\\
336 \leq \mu \leq664
$$


## 02. 모평균의 구간추정

= 평균에 대한 신뢰구간을 추정하는 것!

### 01) 모집단의 분산을 아는 경우



<img src="C:\Users\seok\Documents\파이썬\worldleader\기초통계학\모평균의 구간추정 1.jpg" alt="모평균의 구간추정 1" style="zoom:50%;" />
$$
평균 = \mu, 표준편차 = \frac{\sigma}{\sqrt n} 일 때 
\\
\bar x - z_ \frac{\alpha}{2} * \frac{\sigma}{\sqrt n} \leq \mu \leq \bar{x} + z_ \frac{\alpha}{2} * \frac{\sigma}{\sqrt n}
$$


- 유도과정 
  $$
  Z = \frac {\bar x - \mu}{\sigma / \sqrt n}
  $$
  





#### ! 표준편차 vs 표준오차

- 표준편차 : 하나의 표본 안에서 표본평균으로부터 표본들이 흩어져 있는 산포

- 표준오차 : 표본평균의 표준편차 = 표본이 참값인 모평균에서 얼마나 떨어져있는지 나타낸 것, 표본들을 여러개 뽑아서 이들간의 표준편차를 나타낸 것

  

### 02) 모집단의 분산을 모르는 경우

--> 표본의 분산을 이용한다!

- t 분포 사용 : 모수를 모를때, 추출한 표본의 크기가 작을때

  - 자유도

    - t분포는 자유도에 따라 다른 분포를 나타냄
    - 자유도가 높아질수록 표준정규분포(z분포)의 모양에 가까워진다.
    - 표본의 개수 (n) -1
    - t분포표는 자유도와 신뢰구간의 확률로 t값을 찾는다. 

    
    
    ​	ex, 표본의 개수 12개, 95%의 신뢰도
    
    <img src="C:\Users\seok\Documents\파이썬\worldleader\기초통계학\t분포표.jpg" alt="t분포표" style="zoom: 50%;" />





### 표본의 크기 결정

- 표본의 크기가 커진다는 것은 통계량에 대한 신뢰도가 높아짐을 의미

- 표본의 개수를 무한정 크게 늘릴 수 없음

- 허용오차를 이용해 적절한 표본 개수 n을 구한다.
  $$
  허용오차 (d) = z_\frac{\alpha}{2} * \frac{\sigma}{\sqrt n }
  \\
  n = (\frac {z_\frac{\alpha}{2}*\sigma}{d})^2
  $$
  
  - 대부분 모수를 알기 어려워 모표준편차를 알기 힘들고, 표본을 추출하기 전이므로 표본표준편차s를 사용하기도 힘들다.

    --> 몇 개의 표본에서 표준편차를 구하거나 / 과거의 데이터를 이용해서 구한다. 



### 03. 모집단 비율 및 분산의 구간추정



#### 01) 모집단 비율



- 비율p에 관한 추정

- 표본비율에 대한 신뢰구간으로 표현
  $$
  표본비율(\hat{p}) = \frac{특정사건 (t)}{표본의 개수(n)}
  \\
  \hat{p}-z_\frac{\alpha}{2} \sqrt\frac{\hat{p}(1-\hat{p})}{n}\leq p \leq \hat{p}+z_\frac{\alpha}{2} \sqrt\frac{\hat{p}(1-\hat{p})}{n}
  $$
  
  - 표준오차 도출방법 : 발생했다 or 발생하지 않았다에 관련한 분포이므로 '이항분포'를 이용한다.

  - 이항분포
    $$
    평균 =p, 분산V(x)=p(1-p)
    $$
    

    표준오차는 표본평균들과 모평균 사이의 오차를 의미하므로 
    $$
    표준오차 = \sqrt \frac {분산}{표본의 개수 (n)} = \sqrt \frac{\hat{p}(1-\hat{p})}{n}
    $$
    

#### 02) 표본의 크기 결정

$$
d =z_\frac{\alpha}{2} \sqrt\frac{\hat{p}(1-\hat{p})}{n}
\\
n = \hat{p}(1-\hat{p})(\frac{z_\frac{\alpha}{2}}{d})^2
$$



#### 03) (모집단) 분산의 구간추정

- 카이제곱 분포 이용(분산의 분포를 나타낼 때)
  $$
  X^2 분포 : 모집단분산= \sigma^2, 표본분산= s^2, 자유도 =n-1
  \\
  X^2_{1-\frac{\alpha}{2}} \leq \frac{(n-1)s^2}{\sigma^2}\leq X^2_{\frac{\alpha}{2}}
  \\
  \frac{(n-1)s^2}{X^2_{\frac{\alpha}{2}}} \leq \sigma^2 \leq\frac{(n-1)s^2}{X^2_{1-\frac{\alpha}{2}}}
  $$

  - 카이제곱 분포에서 상한과 하한을 다르게 표현하는 이유?
    - 분산을 나타내는 것이므로 음수가 나올 수 없다(제곱값) = 좌우 대칭이 아니다.
    - 모수를 포함하지 않을 알파 값을 이용해 표현한다. 



### 연습문제

1. 추정 개념, 방법, 추정치와 추정량을 설명하시오

   추정은 표본을 통해 모수를 가늠하는 것이다. 모수를 추정하는 방법에는 점추정과 구간추정이 있는데 점추정은 모수를 특정한 수치로 표현한 것이고 구간추정은 모수를 최소값과 최대값의 범위로 추정하는 것이다. 추정치는 표본을 대상으로 구체적으로 도출한 통계량을 의미하고, 추정량은 추정치를 계산하기 위한 도출함수를 의미한다.

   

2. 바람직한 점추정량이 되기 위한 조건

   1) 표본의 크기가 모집단 규모에 근접해야한다는 일치성, 

   2) 추정량이 모수와 같아야한다는 불편성,

    3) 추정량의 분산이 최소값이어야 한다는 유효성, 

   4) 평균오차제곱이 최소값이어야 한다는 평균오차제곱, 

   5) 표본이 모집단의 대표성을 가져야 한다는 충분성이 있다.



3. 구간추정의 개념과 필요한 이유

   점추정은 명확한 수치를 제시하지만 이는 신뢰도에 문제가 있다. 따라서 이를 보완하기 위해 신뢰도를 제시하면서 상한값과 하한값으로 모수를 추정하는 구간추정을 사용한다.

4. 평균=81점, 표준오차9점일때 신뢰수준 90%, 95%,99%의 모평균을 추정하시오.

   1) 90%
   $$
   81-1.64*9 \leq \mu \leq  81 +1.64*9
   $$
   2) 95%
   $$
   81-1.96*9 \leq \mu \leq  81 +1.96*9
   $$
   3) 99%
   $$
   81-2.58*9 \leq \mu \leq  81 +2.58*9
   $$
   
5. 신뢰수준과 신뢰구간의 개념

   신뢰수준은 추정값이 존재하는 구간에 모수가 포함될 확률이고, 

   신뢰구간은 신뢰수준을 기준으로 추정된 점으로부터 (-)방향과 (+)방향으로 하한과 상한을 표시한 것이다.

6.  통계조사에서 100% 신뢰구간을 사용하지 않는 이유

   신뢰도가 올라갈수록 z의 값이 올라가는데 100%에 해당하는 z값은 무한이다. 이 조사가 틀릴 확률은 0%지만 전혀 의미 없는 결과가 된다. 따라서 신뢰도를 약간 낮추더라도 유의미한 구간을 확인한다.

7. 표준편차 : 함수마법사 - STDEV.P

   모분산을 아는 경우 표준오차 = 
   $$
   \frac {\sigma}{\sqrt{n}}
   $$

8. 표준편차와 표준오차의 개념

   표준편차는 표본평균으로부터 표본들의 흩어져있는 산포를 나타내기 위하여 분산을 먼저 구한 후 다시 제곱근을 취한 값이다. 모평균을 알 수 없으므로 표본평균으로 모평균을 추정했으며, 표본의 분포를 확인하고자 표준편차를 구했다. 즉 모평균을 추정하기 위해 표본을 추출해서 표본의 평균과 표본의 특성을 나타내는 것이 표준편차이다.

   표준오차는 모평균을 추정하는 표본평균의 산포도를 나타내는데, 추출된 표본들의 숫자를 늘려서 평균을 구한 후 이들간의 표준편차를 나타낸 것이며, (표본평균의) 표준오차라 한다. 표준편차를 표준오차와 비교할 때의 가장 큰 장점은 표준오차가 줄어들수록 평균을 나타내는 점들이 집중적으로 모여 있는 것이므로 모수의 추정이 정확하게 이루어졌음을 판단할 수 있다.

   10. 문구점에서 판매되는 스카치테이프의 길이를 조사하고자한다.
   
       (a) 최소 몇개의 표본으로 계산해야하는가?

$$
n=(\frac{z_\frac{\alpha}{2} *\sigma }{d})^2 = (\frac{1.96*22}{30})^2=2.0659271
$$

​			최소 3개의 표본

​				(b)
$$
n=(\frac{z_\frac{\alpha}{2} *\sigma }{d})^2 = (\frac{1.96*16}{30})^2=19.2370
$$
​				최소 20개의 표본



11. 

$$
\hat{p}= \frac{20}{100} = 0.2
\\
\hat{p}+-z_\frac{\alpha}{2} * \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}
\\
n=100,  z_\frac{\alpha}{2}=1.64
\\
0.1344 \leq p \leq0.2656
$$

12.
$$
z_\frac{\alpha}{2}=1.96,  \hat{p}=0.95, d= 0.1
\\
n= 0.95 * 0.05 * (\frac{1.96}{0.1})^2 = 18.25
$$


13.

카이제곱분포는 분산의 산포도를 나타내므로, 제곱근 값을 가지는 분산은 음의 값을 가질수 없고, 좌우 대칭모양이 아니기 때문이다. 



14. 분산추정 - 카이제곱 추정

$$
X^2 분포 : 모집단분산= \sigma^2, 표본분산= s^2, 자유도 =n-1
\\
X^2_{1-\frac{\alpha}{2}} \leq \frac{(n-1)s^2}{\sigma^2}\leq X^2_{\frac{\alpha}{2}}
\\
\\
\frac{(n-1)s^2}{X^2_{\frac{\alpha}{2}}} \leq \sigma^2 \leq\frac{(n-1)s^2}{X^2_{1-\frac{\alpha}{2}}}
\\

n=120, s^2=17,  X_{1-\frac{\alpha}{2}}^2 = 128.42, X_\frac{\alpha}{2}^2 = 73.36
\\
15.753 \leq \sigma^2 \leq25.576
$$

